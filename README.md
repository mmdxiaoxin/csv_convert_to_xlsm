# CSV转Excel工具使用说明

本工具提供两个VBA宏文件，用于将CSV文件导入到Excel工作簿中，并自动进行格式化处理。这两个文件是相同功能的脚本，只是编码不同：

- `ImportCSV_UTF8_ToSheets_UTF8.bas`：UTF-8编码的脚本文件
- `ImportCSV_UTF8_ToSheets_GB2312.bas`：GB2312编码的脚本文件（复制到Excel防止乱码）

## 功能特点

- 自动导入指定文件夹中的所有CSV文件
- 自动创建工作表并命名
- 自动格式化表格（三线表格式）
- 自动处理空单元格
- 自动调整列宽
- 支持中文编码

## 使用前准备

方法一：导入文件

1. 打开Excel，按下`Alt + F11`打开VBA编辑器
2. 在VBA编辑器中，右键点击左侧项目浏览器中的`VBAProject`，选择"导入文件"
3. 选择导入以下文件之一：
   - 如果您的Excel显示中文正常，导入`ImportCSV_UTF8_ToSheets_UTF8.bas`
   - 如果您的Excel显示中文乱码，导入`ImportCSV_UTF8_ToSheets_GB2312.bas`

方法二：新建模块复制代码

1. 打开Excel，按下`Alt + F11`打开VBA编辑器
2. 在VBA编辑器中，右键点击左侧项目浏览器中的`VBAProject`，选择"插入" -> "模块"
3. 将以下代码复制到新建的模块中：
   - 如果您的Excel显示中文正常，复制`ImportCSV_UTF8_ToSheets_UTF8.bas`中的代码
   - 如果您的Excel显示中文乱码，复制`ImportCSV_UTF8_ToSheets_GB2312.bas`中的代码

## 使用步骤

### 步骤1：准备CSV文件

1. 确保您的CSV文件是UTF-8编码格式
2. 将所有需要导入的CSV文件放在同一个文件夹中
3. 默认文件夹路径为：`D:\桌面\毕业设计\assets\static`
4. 如需修改文件夹路径，请打开VBA编辑器，找到`ImportCSV_UTF8_ToSheets`子程序
5. 修改`folderPath`变量的值为您实际的文件夹路径

### 步骤2：运行宏

1. 在Excel中，按下`Alt + F8`打开宏对话框
2. 在宏列表中选择`ImportCSV_UTF8_ToSheets`
3. 点击"运行"按钮

### 步骤3：查看结果

1. 程序会自动为每个CSV文件创建一个新的工作表
2. 工作表名称将基于CSV文件名自动生成
3. 表格将自动进行以下格式化：
   - 应用三线表格式
   - 设置宋体字体（表头为黑体）
   - 字体大小为10.5磅(五号)
   - 所有内容居中对齐
   - 自动调整列宽
   - 空单元格替换为"-"
   - 添加表号（格式：表X-X）

## 示例文件

本工具附带了一个示例Excel文件（`示例-VBA已经配置完毕.xlsm`），其中已经配置好了VBA代码。您可以直接使用这个文件，只需要：

1. 打开`示例-VBA已经配置完毕.xlsm`文件
2. 按下`Alt + F11`打开VBA编辑器
3. 找到`ImportCSV_UTF8_ToSheets`子程序
4. 修改`folderPath`变量的值为您的CSV文件所在文件夹路径
5. 保存文件
6. 运行宏即可

## 注意事项

1. 确保Excel没有被禁用宏
2. 确保有足够的权限访问CSV文件所在的文件夹
3. 工作表名称不能超过31个字符
4. 如果工作表名称重复，程序会自动添加数字后缀
5. 如果遇到错误，请检查：
   - CSV文件格式是否正确（必须是UTF-8编码）
   - 是否使用了正确编码的VBA文件（如果Excel显示中文乱码，请使用GB2312版本）
   - 文件夹路径是否正确
   - Excel是否正常运行

## 常见问题解决

1. 如果出现"无法创建工作表"错误：
   - 检查Excel是否正常运行
   - 检查是否有足够的内存

2. 如果出现"无法创建查询表"错误：
   - 检查CSV文件格式是否正确（确保是UTF-8编码）
   - 确保文件没有被其他程序占用

3. 如果VBA编辑器中的中文显示乱码：
   - 请使用`ImportCSV_UTF8_ToSheets_GB2312.bas`文件
   - 这个文件专门用于解决VBA编辑器中的中文乱码问题

4. 如果导入的CSV文件显示乱码：
   - 确保CSV文件是UTF-8编码格式
   - 可以使用记事本打开CSV文件，选择"另存为"，在保存对话框底部的"编码"下拉框中选择"UTF-8"

## 技术支持

如有问题，请检查：

1. CSV文件格式是否正确（必须是UTF-8编码）
2. 是否使用了正确编码的VBA文件（根据Excel中文显示情况选择）
3. 文件夹路径是否正确
4. Excel是否正常运行
